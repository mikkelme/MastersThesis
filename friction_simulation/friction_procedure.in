variable dt index 0.001 #0.0025
variable T index 100.0
variable relax_time index 1
variable stretch_speed_pct equal 0.05
variable pause_time1 index 1
variable pause_time2 index 1 
variable drag_speed index 2 
variable drag_length index 10
variable K index 1.8724527210000002 
variable root index ..
variable out_ext index test
variable config_data index sheet_only
# variable config_data index sheet_substrate_test
variable stretch_max_pct index 0.2
variable drag_dir_x index 0 
variable drag_dir_y index 1 
variable F_N index 62.41 
variable F_N index 200.0 

variable num_stretch_files index 0
variable run_rupture_test index 1


variable SMAX equal $(v_stretch_max_pct) 

# Run rupture test or standard friciton simulation 
if "${run_rupture_test}" then &
"variable detection_freq equal 100" &
"variable YS_mean_vals_stretch equal 10" &
"variable YS_vals_stretch equal 10" &
"variable cluster_vals_stretch equal 100" &
"include ${root}/stretch.in" &
"variable SMAX equal {rup_stretch}" &

#######
# Possible solution from here
# take SMAX from file and start new simulations
# after calling clear. Thus we might be able to 
# put things back as they were before defining SMAX
# for this remember the to_stretch_max_pct trick in drag.
#######




include ${root}/stretch.in
include ${root}/drag.in




# Run in my_simulation_space
# mpirun -n 4 lmp_mpi -in ../stretch.in -var num_stretch_files 3 -var dt 0.001 -var T 100.0 -var relax_time 1 -var pause_time1 5 -var pause_time2 5 -var stretch_speed_pct 0.01 -var drag_speed 0.01 -var drag_length 1.0 -var K 1.8724527210000002 -var root .. -var out_ext test -var config_data sheet_only -var stretch_max_pct 0.1 -var drag_dir_x 0 -var drag_dir_y 1 -var F_N 6.24150907 -var run_rupture_test 0

# Produce restart files
# mpirun -n 4 lmp_mpi -in ../stretch.in -var num_stretch_files 3 -var dt 0.001 -var T 100.0 -var relax_time 1 -var pause_time1 5 -var pause_time2 5 -var stretch_speed_pct 0.1 -var drag_speed 0.01 -var drag_length 1.0 -var K 1.8724527210000002 -var root .. -var out_ext test -var config_data sheet_substrate_only -var stretch_max_pct 0.1 -var drag_dir_x 0 -var drag_dir_y 1 -var F_N 6.24150907 

# Start from restart file
# mpirun -n 4 lmp_mpi -in ../drag.in -var dt 0.001 -var T 100.0 -var relax_time 1 -var pause_time1 5 -var pause_time2 5 -var stretch_speed_pct 0.05 -var drag_speed 0.01 -var drag_length 1.0 -var K 1.8724527210000002 -var root .. -var out_ext test -var config_data sheet_substrate_nocuts -var stretch_max_pct 0.1 -var drag_dir_x 0 -var drag_dir_y 1 -var F_N 6.24150907 -var restart_file ./stretch_2000_restart

